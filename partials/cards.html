<div class="card-holder"
     data-ng-class="{'box-holder':selected!=phrase.letters, 'box-wider':selected==phrase.letters}"
     data-ng-repeat="phrase in next | objectAsArray | filter: rf | filter: {letters: mtd.convertLetters(fltr)} | filter:search | orderBy:[mtd.rate.ratingSort, mtd.rate.seenSort]">

    <card close="nxt=''" nxt="nxt" mtd="mtd"  data-ng-show="nxt"></card>

    <div class="card" data-ng-class="{'lower':nxt}">

        <div data-ng-click=" nxt=''"
             data-ng-style="{backgroundColor:mtd.colorize(phrase.letters)}"
             data-ng-class="{'fuller':!phrase.text}"
             class="box-head">

            <div class="box-bar">

                <div data-ng-if="mtd.persona"
                     letters
                     class="letters shadow" mtd="mtd" letter="phrase.letters"
                     class="box-top"> </div>

                <div data-ng-if="mtd.persona" class="box-rate">
                    <div class="plus" data-ng-class="{'active':mtd.rate.getPluses(phrase.letters)}" data-ng-click="mtd.rate.plus(phrase)">+{{mtd.rate.getPluses(phrase.letters)}}</div>
                    <div class="zero" data-ng-class="{'active':mtd.rate.getZeros(phrase.letters)}" data-ng-click="mtd.rate.zero(phrase)">{{mtd.rate.getZeros(phrase.letters) || '&bull;'}}</div>
                    <div class="minus" data-ng-class="{'active':mtd.rate.getMinuses(phrase.letters)}" data-ng-click="mtd.rate.minus(phrase)">-{{mtd.rate.getMinuses(phrase.letters)}}</div>
                </div>

            </div>

            <div class="box-icon"
                 data-ng-if="phrase.icon"
                 data-ng-click="imgClick()"
                    >
                <img class="intense"
                     data-image="{{phrase.icon}}"
                     data-title="{{phrase.head}}"
                     data-caption="{{phrase.text}}"
                     data-ng-src="{{phrase.icon}}">
            </div>


            <div class="box-heading"
                 data-ng-click="$parent.selected=mtd.select(phrase.letters, $parent.selected)"
                 data-ng-if="phrase.head">
                <h3>
                    {{phrase.head}}
                </h3>
            </div>



        </div>



        <div  class="box-text" data-ng-if="phrase.text || phrase.next">

            <div class="box-img intense"  data-ng-click="imgClick()" data-image="{{phrase.img}}" data-title="{{phrase.head}}" data-caption="{{phrase.text}}"  data-ng-if="phrase.img">
                <img data-ng-src="{{phrase.img}}">
            </div>

            <div class="text-flow"  data-ng-if="phrase.text" marked="phrase.text"></div>

            <div data-ng-hide="selected==phrase.letters" data-ng-if="phrase.next" class="box-bottom">
                <div data-ng-click="$parent.$parent.$parent.nxt=next"
                     data-ng-style="{backgroundColor:mtd.colorize(next.letters),flexGrow:next.head.length+1}"
                     class="box-preview" data-ng-repeat="next in phrase.next | objectAsArray | filter: rf | filter: {letters: mtd.convertLetters(fltr)} | filter:search">
                    {{next.letter}}
                </div>
            </div>

        </div>
        <div data-ng-if="phrase.next" data-ng-show="$parent.selected==phrase.letters" class="box-roll" data-ng-style="{borderColor:mtd.colorize(phrase.letter)}" >
            <div class="roll-back" data-ng-style="{borderColor:mtd.colorize(phrase.letter),backgroundColor:mtd.colorize(phrase.letters)}"></div>

            <cards search="search" rf="rf" fltr="fltr" mtd="mtd" next="phrase.next" selected="sel" class="container"></cards>

        </div>

    </div>

</div>
<div data-ng-if="mtd.persona" plus></div>